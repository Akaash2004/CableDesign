graph TD
    User([User])
    
    subgraph Frontend [Next.js App :3001]
        UI[DesignValidatorPage]
        Form[DesignInputForm]
        Table[ValidationResultsTable]
        Panel[AiReasoningPanel]
    end

    subgraph Backend [NestJS API :3000]
        Controller[DesignValidationController]
        Service[DesignValidationService]
        AIService[AiIntegrationService]
        MockEngine[Dynamic Mock Heuristics]
    end

    subgraph External [AI Provider]
        LLM[Ollama / OpenAI]
    end

    User -->|Inputs Design| UI
    UI -->|POST /validate| Controller
    Controller -->|DTO| Service
    Service -->|Build Prompt| AIService
    
    AIService -->|Check Config/Status| Connection{Connected?}
    
    Connection -- Yes --> LLM
    LLM -->|JSON Response| AIService
    
    Connection -- No/Fail --> MockEngine
    MockEngine -->|Heuristic Response| AIService
    
    AIService -->|ValidationResult| Service
    Service -->|Response| UI
    UI -->|Display Results| User
